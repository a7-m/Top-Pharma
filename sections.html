<!doctype html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù…Ø§Ø¯Ø© - Top Pharma</title>
    <link rel="stylesheet" href="css/style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <script src="js/theme.js"></script>
  </head>
  <body>
    <!-- Navigation -->
    <nav class="navbar">
      <div class="container navbar-container">
        <a href="index.html" class="navbar-brand">
          ğŸ’Š <span>Top Pharma</span>
        </a>
        <ul class="navbar-menu">
          <li><a href="dashboard.html" class="navbar-link">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a></li>
          <li><a href="profile.html" class="navbar-link">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</a></li>
          <li><a href="videos.html" class="navbar-link">Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª</a></li>
          <li><a href="quizzes.html" class="navbar-link">Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</a></li>
          <li><a href="files.html" class="navbar-link">Ø§Ù„Ù…Ù„ÙØ§Øª</a></li>
          <li>
            <a
              href="#"
              onclick="
                signOut();
                return false;
              "
              class="navbar-link btn btn-secondary"
              >ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a
            >
          </li>
        </ul>
      </div>
    </nav>

    <!-- Header -->
    <section class="hero" style="padding: 3rem 0; background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); color: white;">
      <div class="container">
        <h1 class="hero-title" id="subjectHeader">Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù…Ø§Ø¯Ø©</h1>
        <p class="hero-subtitle">Ø§Ø³ØªÙƒÙ…Ù„ Ù…Ø³ÙŠØ±ØªÙƒ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</p>
        <a href="dashboard.html" class="btn btn-outline" style="color: white; border-color: white; margin-top: 1rem; display: inline-block;">
            Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ÙˆØ§Ø¯ â†
        </a>
      </div>
    </section>

    <!-- Sections Grid -->
    <section class="section">
      <div class="container">
        <div id="sectionsGrid" class="card-grid">
          <!-- Sections will be loaded here -->
        </div>
      </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/config.js"></script>
    <script src="js/supabase.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/section-access.js"></script>
    <script src="js/sections.js"></script>
    <script src="js/subjects.js"></script>

    <script>
      (async () => {
        const isAuth = await requireAuth();
        if (!isAuth) return;

        const subjectId = getSubjectFromURL();
        if (!subjectId) {
            window.location.href = 'dashboard.html';
            return;
        }

        try {
            // Load subject details
            const subject = await getSubjectById(subjectId);
            if (subject) {
                document.getElementById('subjectHeader').textContent = `${subject.icon} ${subject.name_ar}`;
                document.title = `${subject.name_ar} - Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù…Ø§Ø¯Ø©`;
            }

            // Render section cards
            await renderSectionCards("sectionsGrid", subjectId);
        } catch (error) {
            console.error("Error loading sections page:", error);
            showError("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ù…Ø§Ø¯Ø©");
        }
      })();
    </script>
  </body>
</html>
