<!doctype html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ุฅุฏุงุฑุฉ ุงูุทูุงุจ - Top Pharma</title>
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <script src="../js/theme.js"></script>
  </head>
  <body>
    <nav class="navbar">
      <div class="container navbar-container">
        <a href="index.html" class="navbar-brand">
          ๐ <span>Top Pharma Admin</span>
        </a>
        <ul class="navbar-menu">
          <li><a href="index.html" class="navbar-link">ููุญุฉ ุงูุชุญูู</a></li>
          <li><a href="#" id="logoutBtn" class="navbar-link btn btn-outline">ุชุณุฌูู ุงูุฎุฑูุฌ</a></li>
        </ul>
      </div>
    </nav>

    <section class="section">
      <div class="container">
        <div class="auth-card" style="max-width: 1200px; margin: 0 auto;">
          <h2 class="text-center mb-2">ุฅุฏุงุฑุฉ ุงูุทูุงุจ</h2>
          <p class="text-center text-muted mb-4">
            ูุชุงุจุนุฉ ุงูุญุณุงุจุงุชุ ุงูุงุดุชุฑุงูุงุชุ ูุชุนุฏูู ุตูุงุญูุงุช ุงููุตูู ููููุงุฏ.
          </p>

          <div class="student-admin-grid">
            <div class="student-panel">
              <div class="student-panel-header">
                <h3 class="mb-1">ูุงุฆูุฉ ุงูุทูุงุจ</h3>
                <div class="student-stats">
                  <span class="status-pill info" id="studentsCount">0 ุทุงูุจ</span>
                  <span class="status-pill success" id="activeStudentsCount">0 ูุดุชุฑู</span>
                </div>
              </div>

              <div class="form-row mt-2">
                <input
                  type="text"
                  id="studentSearch"
                  class="form-input"
                  placeholder="ุงุจุญุซ ุจุงูุงุณู ุฃู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฃู ุงููุงุชู"
                />
                <select id="subjectFilter" class="form-input">
                  <option value="">ูู ุงูููุงุฏ</option>
                </select>
              </div>

              <div class="table-responsive mt-3">
                <table class="admin-table">
                  <thead>
                    <tr>
                      <th>ุงูุทุงูุจ</th>
                      <th>ุฑูู ุงููุงุชู</th>
                      <th>ุงูุฏูุฑ</th>
                      <th>ุงูููุงุฏ</th>
                      <th>ุชุงุฑูุฎ ุงูุชุณุฌูู</th>
                      <th>ุขุฎุฑ ุฏุฎูู</th>
                    </tr>
                  </thead>
                  <tbody id="studentsTableBody">
                    <tr>
                      <td colspan="6" class="text-center">ุฌุงุฑู ุงูุชุญููู...</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <div class="student-panel">
              <h3 class="mb-2">ุชูุงุตูู ุงูุทุงูุจ</h3>
              <div id="studentDetailsEmpty" class="student-empty-state text-center text-muted">
                ุงุฎุชุฑ ุทุงูุจุงู ูู ุงููุงุฆูุฉ ูุนุฑุถ ุงูุชูุงุตูู ูุฅุฏุงุฑุฉ ุงูุตูุงุญูุงุช.
              </div>

              <div id="studentDetails" hidden>
                <div class="student-card">
                  <div class="student-card-header">
                    <div>
                      <h4 id="detailName">-</h4>
                      <p class="text-muted" id="detailEmail">-</p>
                    </div>
                    <span class="status-pill" id="detailRole">ุทุงูุจ</span>
                  </div>

                  <div class="student-meta-grid mt-3">
                    <div class="student-meta-item">
                      <div class="text-muted">ุชุงุฑูุฎ ุงูุชุณุฌูู</div>
                      <div id="detailCreated">-</div>
                    </div>
                    <div class="student-meta-item">
                      <div class="text-muted">ุขุฎุฑ ุฏุฎูู</div>
                      <div id="detailLastLogin">ุบูุฑ ูุชุงุญ</div>
                    </div>
                    <div class="student-meta-item">
                      <div class="text-muted">ุฑูู ุงููุงุชู</div>
                      <div id="detailPhone">-</div>
                    </div>
                    <div class="student-meta-item">
                      <div class="text-muted">ุนุฏุฏ ุงูููุงุฏ ุงูููุนูุฉ</div>
                      <div id="detailSubjectCount">0</div>
                    </div>
                  </div>
                </div>

                <div class="student-card mt-3">
                  <h4 class="mb-2">ุงูููุงุฏ ุงูููุนูุฉ</h4>
                  <div id="detailSubjects" class="subject-chip-list"></div>

                  <form id="grantAccessForm" class="mt-3">
                    <div class="form-row">
                      <select id="grantSubjectSelect" class="form-input"></select>
                      <button type="submit" class="btn btn-primary">ุชูุนูู ูุงุฏุฉ</button>
                    </div>
                    <small class="text-muted">ุณูุชู ุฅุถุงูุฉ ุงููุงุฏุฉ ููุทุงูุจ ููุฑุงู.</small>
                  </form>
                </div>

                <div class="student-card mt-3">
                  <h4 class="mb-2">ุงูุตูุงุญูุงุช</h4>
                  <div class="form-row">
                    <select id="roleSelect" class="form-input">
                      <option value="student">ุทุงูุจ</option>
                      <option value="admin">ูุดุฑู</option>
                    </select>
                    <button type="button" id="saveRoleBtn" class="btn btn-outline">ุญูุธ ุงูุฏูุฑ</button>
                  </div>
                  <div id="roleMessage" class="mt-2 text-center"></div>
                </div>

                <div class="student-card mt-3">
                  <h4 class="mb-2">ุญุฐู ุงูุญุณุงุจ</h4>
                  <p class="text-muted">
                    ุณูุชู ุญุฐู ุจูุงูุงุช ุงูุทุงูุจ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุงุฆูุงู.
                  </p>
                  <button type="button" id="deleteStudentBtn" class="btn btn-danger">
                    ุญุฐู ุงูุทุงูุจ/ุงููุฏูุฑ
                  </button>
                  <div id="deleteMessage" class="mt-2 text-center"></div>
                </div>

                <div id="detailsMessage" class="mt-3 text-center"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../js/config.js"></script>
    <script src="../js/supabase.js"></script>
    <script src="../js/utils.js"></script>
    <script src="../js/subjects.js"></script>
    <script src="../js/admin.js"></script>
    <script src="../js/students.js"></script>
  </body>
</html>
