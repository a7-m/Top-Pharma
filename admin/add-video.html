<!doctype html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ุฅุถุงูุฉ ููุฏูู - Top Pharma</title>
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="stylesheet" href="../css/responsive.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <script src="../js/theme.js"></script>
  </head>
  <body>
    <nav class="navbar">
      <div class="container navbar-container">
        <a href="index.html" class="navbar-brand">
          ๐ <span>Top Pharma Admin</span>
        </a>
        <ul class="navbar-menu">
          <li><a href="index.html" class="navbar-link">ููุญุฉ ุงูุชุญูู</a></li>
        </ul>
      </div>
    </nav>

    <section class="section">
      <div class="container">
        <div class="auth-card" style="max-width: 800px; margin: 0 auto">
          <h2 class="text-center mb-4">ุฅุถุงูุฉ ููุฏูู ุฌุฏูุฏ</h2>
          <form id="addVideoForm">
            <div class="form-group">
              <label for="title" class="form-label">ุนููุงู ุงูููุฏูู</label>
              <input
                type="text"
                id="title"
                class="form-input"
                required
                placeholder="ูุซุงู: ููุฏูุฉ ูู ุนูู ุงูุฃุฏููุฉ"
              />
            </div>

            <div class="form-group">
              <label for="description" class="form-label">ูุตู ุงูููุฏูู</label>
              <textarea
                id="description"
                class="form-input"
                rows="3"
                placeholder="ูุตู ูุฎุชุตุฑ ููุญุชูู ุงูููุฏูู"
              ></textarea>
            </div>

            <div class="form-group">
              <label for="subject" class="form-label">ุงููุงุฏุฉ ุงูุฏุฑุงุณูุฉ *</label>
              <select id="subject" class="form-input" required>
                <option value="">ุงุฎุชุฑ ุงููุงุฏุฉ...</option>
              </select>
            </div>

            <div class="form-group">
              <label for="section" class="form-label">ุงููุณู *</label>
              <select id="section" class="form-input" required disabled>
                <option value="">ุงุฎุชุฑ ุงููุงุฏุฉ ุฃููุงู...</option>
              </select>
            </div>

            <div class="form-group">
              <label for="category" class="form-label">ุงูุชุตููู</label>
              <select id="category" class="form-input" required>
                <option value="lecture">ูุญุงุถุฑุฉ</option>
                <option value="review">ูุฑุงุฌุนุฉ</option>
                <option value="application">ุชุทุจูู ุนููู</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label">ููุงู ุงูุฑูุน (Hosting)</label>
              <div style="display: flex; gap: 20px; margin-bottom: 10px">
                <label style="cursor: pointer">
                  <input
                    type="radio"
                    name="uploadSource"
                    value="cloudinary"
                    checked
                  />
                  Cloudinary (ุจุซ ุณุฑูุน)
                </label>
                <label style="cursor: pointer">
                  <input type="radio" name="uploadSource" value="google" />
                  Google Drive
                </label>
              </div>
            </div>

            <div class="form-group">
              <label id="uploadLabel" class="form-label"
                >ุฑูุน ููุฏูู (Cloudinary)</label
              >
              <input
                type="file"
                id="videoFile"
                class="form-input"
                accept="video/*"
              />
              <small class="text-muted"
                >ุงุฎุชุฑ ููู ููุฏูู (ุงูุญุฏ ุงูุฃูุตู 100MB)</small
              >

              <div
                id="uploadProgressContainer"
                style="display: none; margin-top: 10px"
              >
                <progress
                  id="uploadProgressBar"
                  value="0"
                  max="100"
                  style="width: 100%; height: 20px"
                ></progress>
                <span
                  id="uploadProgressText"
                  style="display: block; text-align: center; margin-top: 5px"
                  >0%</span
                >
              </div>
            </div>

            <div class="form-group">
              <label for="videoLink" class="form-label"
                >ุฑุงุจุท ุงูููุฏูู (ุณูุชู ุชุนุจุฆุชู ุชููุงุฆูุงู)</label
              >
              <input
                type="text"
                id="videoLink"
                class="form-input"
                placeholder="...or paste external link"
              />
            </div>

            <!-- Optional: Duration, Thumbnail if we want to add later -->

            <button
              type="submit"
              class="btn btn-primary btn-block mt-4"
              id="submitBtn"
            >
              ูุดุฑ ุงูููุฏูู
            </button>
          </form>
          <div id="message" class="mt-3 text-center"></div>
        </div>
      </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../js/config.js"></script>
    <script src="../js/supabase.js"></script>
    <script src="../js/utils.js"></script>
    <script src="../js/subjects.js"></script>
    <script src="../js/sections.js"></script>
    <script src="../js/cloudinary.js"></script>
    <script src="../js/google-drive.js"></script>
    <script src="../js/admin.js"></script>

    <script>
      // Load subjects when page loads
      document.addEventListener("DOMContentLoaded", async () => {
        await renderSubjectSelector("subject", null, true);

        // Add event listener to subject selector to load sections
        const subjectSelect = document.getElementById("subject");
        const sectionSelect = document.getElementById("section");

        subjectSelect.addEventListener("change", async (e) => {
          const subjectId = e.target.value;
          sectionSelect.disabled = false;

          if (subjectId) {
            await renderSectionSelector("section", subjectId, null, true);
          } else {
            sectionSelect.innerHTML =
              '<option value="">ุงุฎุชุฑ ุงููุงุฏุฉ ุฃููุงู...</option>';
            sectionSelect.disabled = true;
          }
        });
      });
    </script>
  </body>
</html>
